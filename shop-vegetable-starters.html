<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Roots to Blooms â€” Houseplants</title>

<style>
:root{
  --brand-green:#4EA337;
  --dark:#254D32;
  --accent:#c6e3d2;
}

/* ====== General ====== */
body{margin:0;font-family:Arial,Helvetica,sans-serif;background:#fafafa;color:#333;}
h1,h2{margin:16px 0 8px 0;text-align:center;color:var(--dark);}
a{text-decoration:none;color:inherit;}

/* ====== Navigation ====== */
.topnav{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:14px 24px;
  background:var(--dark);
  position:sticky;
  top:0;
  z-index:1000;
}
.topnav .logo img{height:48px;}
.nav-links a{
  color:white;
  font-weight:700;
  margin-left:20px;
  padding:8px 12px;
  border-radius:6px;
  transition:0.2s;
}
.nav-links a:hover{background:var(--brand-green);}

/* ====== Dropdown ====== */
.dropdown{
  position:relative;
  display:inline-block;
}
.dropbtn{
  background:var(--dark);
  color:white;
  font-weight:700;
  padding:8px 12px;
  border:none;
  border-radius:6px;
  cursor:pointer;
}
.dropbtn:hover{background:var(--brand-green);}
.dropdown-content{
  display:none;
  position:absolute;
  background:#fff;
  min-width:160px;
  box-shadow:0 8px 16px rgba(0,0,0,0.2);
  border-radius:6px;
  overflow:hidden;
  z-index:1000;
}
.dropdown-content a{
  color:var(--dark);
  padding:12px 16px;
  display:block;
  font-weight:700;
}
.dropdown-content a:hover{background:var(--accent);}
.dropdown:hover .dropdown-content{display:block;}

/* ====== Product Grid ====== */
.product-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(260px,1fr));
  gap:18px;
  padding:20px;
  max-width:1200px;
  margin:auto;
}
.product-card{
  background:#fff;
  border-radius:12px;
  box-shadow:0 6px 12px rgba(0,0,0,0.08);
  overflow:hidden;
  display:flex;
  flex-direction:column;
  cursor:pointer;
  transition:transform 0.15s;
}
.product-card:hover{transform:scale(1.03);}
.product-image{
  width:100%;
  height:160px;
  object-fit:cover;
  background:#f3f3f3;
}
.product-title{
  font-weight:800;
  padding:8px 12px 4px 12px;
  font-size:15px;
  color:var(--dark);
  text-align:center;
}
.product-price{
  padding:0 12px 8px 12px;
  font-weight:700;
  text-align:center;
  color:#555;
  font-size:14px;
}

/* ====== Cart (Desktop & Mobile) ====== */
#floating-cart{
  position:fixed;
  bottom:calc(20px + env(safe-area-inset-bottom));
  right:20px;
  z-index:9999;
  background:var(--accent);
  color:var(--dark);
  padding:12px 16px;
  border-radius:999px;
  box-shadow:0 10px 24px rgba(0,0,0,0.18);
  display:flex;
  gap:8px;
  align-items:center;
  cursor:pointer;
}
#floating-cart .badge{
  background:var(--dark);
  color:#fff;
  padding:2px 8px;
  border-radius:12px;
  font-weight:800;
}

/* Cart drawer simplified */
#cart-drawer{
  position:fixed;
  top:0;
  right:0;
  width:380px;
  bottom:0;
  max-height:calc(100% - 32px); /* accounts for taskbars */
  padding:18px;
  background:#fff;
  z-index:10000;
  box-shadow:-8px 0 30px rgba(0,0,0,0.2);
  display:flex;
  flex-direction:column;
  gap:10px;
  overflow:hidden;
  transition:right .32s ease;
}
#cart-drawer.open{right:0;}
.cart-items{flex:1;overflow-y:auto;-webkit-overflow-scrolling:touch;}
.cart-line{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px dashed #eee;}
.small-btn{background:#eee;border:none;padding:6px 8px;border-radius:6px;cursor:pointer;}
.drawer-footer{flex-shrink:0;background:#fff;border-top:1px solid #f0f0f0;padding-top:12px;display:flex;flex-direction:column;gap:8px;}
.totals{display:flex;justify-content:space-between;font-weight:800;}
</style>
</head>

<body>

<!-- NAVIGATION -->
<nav class="topnav">
  <a href="/" class="logo"><img src="IMG_1466.png" alt="Roots to Blooms Logo"></a>
  <div class="nav-links">
    <a href="/">Home</a>
    <div class="dropdown">
      <button class="dropbtn">Shop â–¼</button>
      <div class="dropdown-content">
        <a href="shop-houseplants.html">Houseplants</a>
        <a href="shop-annuals.html">Annuals</a>
        <a href="shop-vegetable starters.html">Vegetable Starters</a>
      </div>
    </div>
    <a href="/about.html">About</a>
    <a href="/contact.html">Contact</a>
  </div>
</nav>

<h1>Houseplants</h1>
<div id="productGrid" class="product-grid"></div>

<!-- FLOATING CART -->
<div id="floating-cart" title="View cart" onclick="toggleDrawer()">
  ðŸ›’ Cart
  <div class="badge" id="floatBadge">0</div>
</div>

<!-- CART DRAWER -->
<div id="cart-drawer">
  <h3>Your Cart</h3>
  <div id="cartItemsWrap" class="cart-items"></div>
  <div class="drawer-footer">
    <div class="totals"><div>Items</div><div id="cartCount">0</div></div>
    <div class="totals"><div>Total</div><div id="cartSubtotal">$0.00</div></div>
    <div style="display:flex;gap:8px;">
      <button class="small-btn" onclick="toggleDrawer()">Continue Shopping</button>
      <button class="small-btn" onclick="openCheckoutForm()">Checkout</button>
    </div>
  </div>
</div>

<script>
const SHEET_ENDPOINT="https://script.google.com/macros/s/AKfycbxKVOYtyszNwsdNYX8iPZtYyYqDkxryKijLTNH73NqvjPWepLygI4UZ5jZYylBPytPF0A/exec";
const STORAGE_KEY="plant_shop_cart_v8";
const PAGE_CATEGORY="vegetable-starters";
let RAW=[], cart=JSON.parse(localStorage.getItem(STORAGE_KEY)||"{}");

async function fetchProducts(){
  const res = await fetch(`${SHEET_ENDPOINT}?ts=${Date.now()}`);
  RAW = await res.json();
  RAW.forEach(p => { p.stock = Number(p.stock); p.price = Number(p.price); });
  renderProducts();
}

function renderProducts(){
  const grid = document.getElementById("productGrid");
  grid.innerHTML = "";
  RAW.filter(p => (p.categories||[]).map(c=>c.toLowerCase()).includes(PAGE_CATEGORY.toLowerCase()))
     .forEach(p=>{
       const qty = cart[p.id]||0;
       const card = document.createElement('div');
       card.className='product-card';
       card.innerHTML=`
         <img class="product-image" src="${p.photo}" alt="${p.name}">
         <div class="product-title">${p.name}</div>
         <div class="product-price">$${p.price.toFixed(2)}</div>
         <button class="add-btn" onclick="firstAdd('${p.id}')">${qty>0?'Update':'Add'}</button>
       `;
       grid.appendChild(card);
     });
  updateBadges();
}

/* ===== Cart Logic ===== */
const floatBadge=document.getElementById("floatBadge");
const cartCountEl=document.getElementById("cartCount");
const cartSubtotalEl=document.getElementById("cartSubtotal");
const cartDrawer=document.getElementById("cart-drawer");

function firstAdd(id){cart[id]=(cart[id]||0)+1; saveCart(); renderProducts();}
function updateBadges(){
  const itemCount = Object.values(cart).reduce((s,q)=>s+q,0);
  floatBadge.textContent=itemCount;
  cartCountEl.textContent=itemCount;
  const total = Object.entries(cart).reduce((sum,[id,qty])=>{ 
    const p = RAW.find(x=>x.id===id); return sum + (p?p.price*qty:0);
  },0);
  cartSubtotalEl.textContent = `$${total.toFixed(2)}`;
}
function saveCart(){localStorage.setItem(STORAGE_KEY,JSON.stringify(cart)); updateBadges();}
function toggleDrawer(){cartDrawer.classList.toggle("open");}
function openCheckoutForm(){alert("Checkout logic here");}

fetchProducts();
</script>
</body>
</html>
