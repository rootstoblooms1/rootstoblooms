<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Roots to Blooms â€” Houseplants</title>

<script src="/shop/cart.js"></script>

<style>
body{margin:0;font-family:Arial;background:#f5f5f5;}

.topnav{
  display:flex;justify-content:center;gap:14px;
  background:#2e5d3b;padding:12px 0;flex-wrap:wrap;
}
.topnav a{
  color:white;text-decoration:none;font-weight:700;
  padding:8px 16px;border-radius:6px;
}
.topnav a:hover{background:#4EA337;}

.hero{
  height:220px;
  background:url("https://images.unsplash.com/photo-1501004318641-b39e6451bec6?q=80&w=1974") center/cover;
  display:flex;align-items:center;justify-content:center;
  color:white;font-size:42px;font-weight:700;
}

.container{max-width:1100px;margin:auto;padding:20px;}

.filters{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:20px;}
.filters button{
  border:none;padding:8px 14px;border-radius:20px;
  background:#d6e9da;cursor:pointer;
}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(250px,1fr));
  gap:18px;
}

.card{
  background:white;border-radius:10px;
  overflow:hidden;box-shadow:0 2px 6px rgba(0,0,0,0.1);
}
.card img{width:100%;height:180px;object-fit:cover;}
.body{padding:12px;}
.name{font-weight:700;}
.latin{font-size:12px;color:#666;}
.price{margin:6px 0;}

.swatches{display:flex;gap:6px;margin:6px 0;}
.swatch{
  width:18px;height:18px;border-radius:50%;
  border:2px solid #ccc;cursor:pointer;
}

.addBtn{
  width:100%;padding:10px;border:none;
  background:#2e5d3b;color:white;border-radius:6px;
}

.qty{display:flex;justify-content:center;gap:12px;}

.cartFloating{
  position:fixed;bottom:18px;right:18px;
  background:#2e5d3b;color:white;
  padding:12px 18px;border-radius:30px;font-weight:700;
}
</style>
</head>

<body>

<nav class="topnav">
  <a href="/">Home</a>
  <a href="/shop/">Shop</a>
  <a href="/shop/houseplants/">Houseplants</a>
  <a href="/shop/annuals/">Annuals</a>
  <a href="/shop/vegetable-starters/">Vegetable Starters</a>
</nav>

<div class="hero">Houseplants</div>

<div class="container">
  <div id="filters" class="filters"></div>
  <div id="grid" class="grid"></div>
</div>

<div class="cartFloating">
ðŸ›’ Cart <span id="cartCount">0</span>
</div>

<script>
const PAGE_CATEGORY="houseplants";
const SHEET_ENDPOINT="https://script.google.com/macros/s/AKfycbxKVOYtyszNwsdNYX8iPZtYyYqDkxryKijLTNH73NqvjPWepLygI4UZ5jZYylBPytPF0A/exec";

let RAW=[],GROUPS=[],filter="all",hideSold=false;

async function load(){
  RAW=await (await fetch(SHEET_ENDPOINT)).json();
  GROUPS=buildGroups();
  renderFilters();
  render();
}

function buildGroups(){
  let map={};
  RAW.forEach(p=>{
    if(!p.categories.includes(PAGE_CATEGORY)) return;
    if(!map[p.group]) map[p.group]={base:p,vars:[]};
    map[p.group].vars.push(p);
  });
  return Object.values(map);
}

function renderFilters(){
  let tags=new Set();
  GROUPS.forEach(g=>{
    g.base.categories.forEach(c=>{
      if(c!==PAGE_CATEGORY) tags.add(c);
    });
  });

  let html=`<button onclick="setFilter('all')">All</button>`;
  tags.forEach(t=>html+=`<button onclick="setFilter('${t}')">${t}</button>`);
  html+=`<button onclick="toggleSold()">Hide Sold</button>`;

  filters.innerHTML=html;
}

function setFilter(f){filter=f;render();}
function toggleSold(){hideSold=!hideSold;render();}

function render(){
  grid.innerHTML="";
  GROUPS.forEach(g=>{
    let selected=g.vars[0];
    if(filter!=="all" && !selected.categories.includes(filter)) return;
    if(hideSold && selected.stock==0) return;

    let id=selected.id;
    let qty=getQty(id);

    grid.innerHTML+=`
    <div class="card">
      <img src="${selected.photo}">
      <div class="body">
        <div class="name">${selected.name}</div>
        <div class="latin">${selected.latin}</div>
        <div class="price">$${selected.price.toFixed(2)}</div>
        ${
          selected.stock==0
          ? `<div style="color:red">Sold Out</div>`
          : qty==0
          ? `<button class="addBtn" onclick="addToCart('${id}');render()">Add</button>`
          : `<div class="qty">
                <button onclick="removeFromCart('${id}');render()">âˆ’</button>
                ${qty}
                <button onclick="addToCart('${id}');render()">+</button>
            </div>`
        }
      </div>
    </div>`;
  });

  cartCount.innerText=cartCount();
}

load();
</script>

</body>
</html>
